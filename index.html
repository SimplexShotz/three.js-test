<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>My First three.js App</title>
		<style>
      html, body { overflow: hidden; }
			body { margin: 0; position: fixed; top: 0; }
			canvas { display: block; }
		</style>
	</head>
	<body>
    <p id="FPS" style="position: absolute; top: 20px; left: 20px; color: white; z-index: 10000;">Loading...</p>
		<script src="js/three.js"></script>
    <script src="js/OrbitControls.js"></script>
		<script>

      // TUTORIAL (for future reference):
      // https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene

      // Create our scene, camera, and renderer
      var scene = new THREE.Scene();
      //                                      FOV, RATIO,                                  CLIP DISTANCE (near, far)
      var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(10, 10, 10);
      camera.lookAt(0, 0, 0);
      // Add orbit controls for the camera:
      var controls = new THREE.OrbitControls(camera);

      var renderer = new THREE.WebGLRenderer();
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);

      // Display the rendered image:
      document.body.appendChild(renderer.domElement);

      // Make a CUBE!
      // Creates the GEOMETRY for the cube:
      var geometry = new THREE.BoxGeometry();
      // Creates the MATERIAL for the cube:
      var material = new THREE.MeshLambertMaterial({ color: 0x00ff00 });
      // MESHES the geometry and the material together to create our cube:
      var cube = new THREE.Mesh(geometry, material);
      // Add the cube to our scene:
      scene.add(cube);

      // Directional light:
      var directionalLight = new THREE.DirectionalLight(0xffffff, 1);
      directionalLight.position.set(2, 3, 1);
      scene.add(directionalLight);
      // Ambient light:
      var ambientLight = new THREE.AmbientLight(0xffffff, 0.1);
      scene.add(ambientLight);

      // Reposition the camera so we can see the cube:
      camera.position.z = 5;

      var frame = 0;
      var time = new Date().getTime();
      var FPS = 0;

      var totalFrames = 0;
      var totalSeconds = 0;

      var ratioMultiplier = 1;

      // Animate (this function will automatically loop every frame):
      function animate() {
        requestAnimationFrame(animate);
        controls.update();
        frame++;
        if (new Date().getTime() - time >= 1000) {
          document.getElementById("FPS").innerHTML = frame + " FPS (" + ratioMultiplier + ")";

          totalFrames += frame;
          totalSeconds++;

          FPS = frame;
          frame = 0;
          time += 1000;

          // Every 10 seconds, update the resolution (if the average FPS is below 30):
          if (totalSeconds >= 20 && totalSeconds % 10 === 0 && (totalFrames / totalSeconds) <= 30) {
            ratioMultiplier += 0.5;
            renderer.setPixelRatio(window.devicePixelRatio / ratioMultiplier);
          }

        }
        draw();
      	renderer.render(scene, camera);
      }
      animate();

      function draw() {
        // cube.rotation.x += 0.01;
        // cube.rotation.y += 0.01;
        camera.lookAt(0, 0, 0);
      }
		</script>
	</body>
</html>
